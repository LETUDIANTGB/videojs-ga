/*! videojs-ga - v0.1.0 - 2013-11-18
* Copyright (c) 2013 Michael Bensoussan; Licensed  */
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;null==b&&(b={}),c={},this.options()["data-setup"]&&(m=JSON.parse(this.options()["data-setup"]),m.ga&&(c=m.ga)),d=["loaded","percentsPlayed","start","srcType","end","seek","play","pause","resize","volumeChange","error","fullscreen"],j=b.eventsToTrack||c.eventsToTrack||d,p=b.percentsPlayedInterval||c.percentsPlayedInterval||10,g=b.eventActionPrefix||c.eventActionPrefix||"",h=b.eventCategory||c.eventCategory||"Video",i=b.eventLabel||c.eventLabel,y=y||[],o=[],t=s=0,u=!1,l=function(){var b,c;i||(i=this.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),a.call(j,"loadedmetadata")>=0&&w("loadedmetadata"),a.call(j,"srcType")>=0&&(c=this.currentSrc().split("."),b=c[c.length-1],w("srcType",""+this.techName+"/"+b))},v=function(){var b,c,d,e,f;for(b=Math.round(this.currentTime()),c=Math.round(this.duration()),e=Math.round(b/c*100),d=f=0;99>=f;d=f+=p)e>=d&&a.call(o,d)<0&&(a.call(j,"start")>=0&&0===d&&e>0?w("start"):a.call(j,"percentsPlayed")>=0&&0!==e&&w(""+d),e>0&&o.push(d));a.call(j,"seek")>=0&&(t=s,s=b,Math.abs(t-s)>1&&(u=!0,w("seek start",t),w("seek end",s)))},e=function(){w("end")},q=function(){var a;a=Math.round(this.currentTime()),a>0&&!u&&w("play",a),u=!0},n=function(){var a,b;a=Math.round(this.currentTime()),b=Math.round(this.duration()),a===b||u||w("pause",a)},x=function(){var a;a=this.muted()===!0?0:this.volume(),w("volumeChange",a)},r=function(){w("resize",""+this.width+"*"+this.height)},f=function(){var a;a=Math.round(this.currentTime()),w("error",a)},k=function(){var a;a=Math.round(this.currentTime()),this.isFullScreen?w("enter fullscreen",a):w("exit fullscreen",a)},w=function(a,b){var c,d,e;return e=function(){var b,d,e,f;for(e=a.split(" "),f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(g+c);return f}().join(" "),d=["_trackEvent",h,e,i],b&&d.push(b),y.push(d)},this.on("loadedmetadata",l),this.on("timeupdate",v),a.call(j,"end")>=0&&this.on("ended",e),a.call(j,"play")>=0&&this.on("play",q),a.call(j,"pause")>=0&&this.on("pause",n),a.call(j,"volumeChange")>=0&&this.on("volumechange",x),a.call(j,"resize")>=0&&this.on("resize",r),a.call(j,"error")>=0&&this.on("error",f),a.call(j,"fullscreen")>=0&&this.on("fullscreenchange",k)})}).call(this);